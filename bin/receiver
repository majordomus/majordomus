#!/bin/bash

#  repository=$1
#  revision=$2
#  username=$3
#  fingerprint=$4
#  contents=@

# load global vars
source /etc/majord.conf

REPO=/opt/majordomus/majord-data/git/$1

mkdir -p $REPO && cat | tar -x -C $REPO

echo "----> Receiving new/updated files for '$1'" 

if [ -f "$REPO/Dockerfile" ]; then
	echo "----> Building docker image"
	cd $REPO && docker build -t $ORGANIZATION/$1 .
else
	echo "----> Something else. $1 $2 $3"
	docker images
fi